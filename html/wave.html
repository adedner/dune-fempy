

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Wave equation in a slit domain &mdash; dune-fempy 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Saddle point solver (using Scipy)" href="uzawa-scipy.html" />
    <link rel="prev" title="Spiral Wave" href="spiral.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> dune-fempy
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation (out of date)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#building-the-dune-core-modules">Building the Dune Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#setting-up-the-python-module">Setting up the python module</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#troubleshooting">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">A first Example and General Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dune-fempy.html">Finite Element Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="dune-fempy.html#alternate-solve-methods">Alternate Solve Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="dune-fempy.html#more-general-boundary-conditions">More General Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="dune-fempy.html#a-3d-example">A 3D example</a></li>
<li class="toctree-l1"><a class="reference internal" href="dune-fempy.html#listing-installed-components">Listing installed components</a></li>
</ul>
<p class="caption"><span class="caption-text">Using the Dune Grid Interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dune-corepy.html">A quick survey of Dune-Common and Dune-Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="dune-corepy.html#grid-construction">Grid Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dune-corepy.html#basic-grid-usage">Basic Grid Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="dune-corepy.html#grid-functions">Grid Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="dune-corepy.html#attaching-data-to-the-grid">Attaching Data to the Grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="dune-corepy.html#output">Output</a></li>
</ul>
<p class="caption"><span class="caption-text">Some Further Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="elasticity.html">Linear elasticity: deformed beam</a></li>
<li class="toctree-l1"><a class="reference internal" href="spiral.html">Spiral Wave</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Wave equation in a slit domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="uzawa-scipy.html">Saddle point solver (using Scipy)</a></li>
</ul>
<p class="caption"><span class="caption-text">Grid Adaptivity</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="laplace-adaptive.html">Re-entrant Corner Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="crystal.html">Crystal Growth</a></li>
</ul>
<p class="caption"><span class="caption-text">Moving Grids</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mcf.html">Mean Curvature Flow</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="twophaseflow.html">HP adaptive DG scheme for twophase flow problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="vemdemo.html">Demonstration notebook for the DUNE-VEM module</a></li>
</ul>
<p class="caption"><span class="caption-text">Information and Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="additional.html">Notebooks and Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional.html#mesh-files-used-in-the-examples">Mesh Files used in the Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional.html#contributing-to-this-documentation">Contributing to this Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional.html#reporting-a-bug">Reporting a Bug</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional.html#citing-this-project">Citing this project</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dune-fempy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="furtherexamples.html">&lt;no title&gt;</a> &raquo;</li>
        
      <li>Wave equation in a slit domain</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/wave.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="wave-equation-in-a-slit-domain">
<h1>Wave equation in a slit domain<a class="headerlink" href="#wave-equation-in-a-slit-domain" title="Permalink to this headline">Â¶</a></h1>
<p><a class="reference download internal" download="" href="_downloads/17039fae08775438cd5cce5b20b7cc82/wave_nb.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">(notebook)</span></code></a> <a class="reference download internal" download="" href="_downloads/24946d838925629824a9fa5865761ad7/wave.py"><code class="xref download docutils literal notranslate"><span class="pre">(script)</span></code></a></p>
<p>In the following we will consider the wave equation</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
  \partial_{tt}\psi - \Delta\psi &amp;= 0, &amp;&amp; \text{in } \Omega\times(0,T), \\
          \psi &amp;= g, &amp;&amp; \text{on } \Gamma_D\times(0,T), \\
     \nabla\psi\cdot n &amp;= 0 &amp;&amp; \text{on } \partial\Omega\setminus\Gamma_D,
\end{align*}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the outward unit normal and <span class="math notranslate nohighlight">\(g\)</span> is given
Dirichlet data given on part of the domain boundary. We repeat a double
slit experiment, i.e., we have a wave channel which ends in two slits on
the right and forcing the wave on the left end by defining #
<span class="math notranslate nohighlight">\(g=\frac{1}{10\pi}\cos(10\pi t)\)</span>.</p>
<p>We discretize the wave equation by an explicit symplectic time stepping
scheme for two unknowns <span class="math notranslate nohighlight">\(\psi^n\)</span> and <span class="math notranslate nohighlight">\(p^n\)</span> where
<span class="math notranslate nohighlight">\(p=-\partial_t\psi\)</span> based on</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
  \partial_t \psi = -p, \\
  \partial_t p    = -\triangle\psi
\end{align*}\end{split}\]</div>
<p>The discretization first updates <span class="math notranslate nohighlight">\(\psi\)</span> by half a time step then
updates <span class="math notranslate nohighlight">\(p\)</span> and concludes by another update step for <span class="math notranslate nohighlight">\(\psi\)</span>.
So given <span class="math notranslate nohighlight">\((\psi^n,p^n)\)</span> we compute</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
  \psi^{n+\frac{1}{2}} &amp;= \psi^n - \frac{\Delta t}{2}p^n, \\
  p^{n+1}              &amp;=
      \begin{cases}
           p^n - \triangle\psi^{n+\frac{1}{2}} &amp; \text{in the interior}, \\
           g(t^{n+1}) &amp; \text{on }\Gamma_D
      \end{cases} \\
  \psi^{n+1}           &amp;= \psi^{n+\frac{1}{2}} - \frac{\Delta t}{2}p^{n+1}.
\end{align*}\end{split}\]</div>
<p>Note that the update for <span class="math notranslate nohighlight">\(\psi\)</span> does not involve any spatial
derivatives so can be performed directly on the level of the degree of
freedom vectors. We use <span class="math notranslate nohighlight">\(\emph{numpy}\)</span> for these steps. For
the update of <span class="math notranslate nohighlight">\(p\)</span> we use a variational formulation</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
  \vec{p} &amp;= \vec{p} + M^{-1}S\vec{\psi}
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is the stiffness matrix
<span class="math notranslate nohighlight">\(S=(\int_\Omega\nabla\varphi_j\nabla\varphi_i)_{ij}\)</span> and <span class="math notranslate nohighlight">\(M\)</span>
is the mass matrix, i.e., <span class="math notranslate nohighlight">\(M=\int_\Omega\varphi_j\varphi_i)_{ij}\)</span>.
To simplify the computation we use a lumped version of this matrix,
i.e,, <span class="math notranslate nohighlight">\(M\approx{\rm diag}(\int_\Omega\varphi_i)\)</span>. In this form the
algorithm only involves a matrix vector multiplication and no implicit
solving step is required.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span> <span class="p">)</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">dune.fem</span> <span class="k">as</span> <span class="nn">fem</span>
<span class="kn">from</span> <span class="nn">dune.grid</span> <span class="k">import</span> <span class="n">reader</span>
<span class="kn">from</span> <span class="nn">dune.alugrid</span> <span class="k">import</span> <span class="n">aluConformGrid</span> <span class="k">as</span> <span class="n">leafGridView</span>
<span class="kn">from</span> <span class="nn">dune.fem.space</span> <span class="k">import</span> <span class="n">lagrange</span> <span class="k">as</span> <span class="n">solutionSpace</span>
<span class="kn">from</span> <span class="nn">ufl</span> <span class="k">import</span> <span class="n">TrialFunction</span><span class="p">,</span> <span class="n">TestFunction</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">dot</span><span class="p">,</span> <span class="n">dx</span>
<span class="kn">from</span> <span class="nn">dune.ufl</span> <span class="k">import</span> <span class="n">Constant</span><span class="p">,</span> <span class="n">BoxDirichletBC</span>
<span class="n">fem</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;fem.verboserank&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>We use <span class="math notranslate nohighlight">\(\emph{gmsh}\)</span> to define the domain and then set up a
first order scalar Lagrange space which we will use both for
<span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\(p\)</span>. We can construct general grids by either
defining the grids directly in Python (as demonstrated in the following
example) or by reading the grid from files using readers provided by
Dune, e.g., Dune Grid Format (dgf) files or Gmsh files.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">domain</span> <span class="o">=</span> <span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">gmsh</span><span class="p">,</span> <span class="s2">&quot;wave_tank.msh&quot;</span><span class="p">)</span>
<span class="n">gridView</span>  <span class="o">=</span> <span class="n">leafGridView</span><span class="p">(</span> <span class="n">domain</span><span class="p">,</span> <span class="n">dimgrid</span><span class="o">=</span><span class="mi">2</span> <span class="p">)</span>
<span class="n">gridView</span><span class="o">.</span><span class="n">hierarchicalGrid</span><span class="o">.</span><span class="n">loadBalance</span><span class="p">()</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">solutionSpace</span><span class="p">(</span><span class="n">gridView</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">storage</span><span class="o">=</span><span class="s2">&quot;fem&quot;</span><span class="p">)</span>

<span class="n">p</span>      <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">phi</span>    <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;phi&quot;</span><span class="p">)</span>
<span class="n">pVec</span>   <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">as_numpy</span>
<span class="n">phiVec</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">as_numpy</span>
</pre></div>
</div>
<p>Next we define an operator for the stiffness matrix including the
boundary condition which are time dependent so we use a <code class="docutils literal notranslate"><span class="pre">Constant</span></code> for
this. We use the <code class="docutils literal notranslate"><span class="pre">BoxDirichletBC</span></code> class which is derived from the more
general <code class="docutils literal notranslate"><span class="pre">DirichletBC</span></code> class which takes a function space, the boundary
function <span class="math notranslate nohighlight">\(g\)</span> as a ufl expression, and finally a description of the
part <span class="math notranslate nohighlight">\(\Gamma_D\)</span> of the boundary where this boundary condition is
defined. This can be a ufl expression which evaluates to <span class="math notranslate nohighlight">\(0\)</span> for
<span class="math notranslate nohighlight">\(x\not\in\Gamma_D\)</span>, e.g., an ufl <code class="docutils literal notranslate"><span class="pre">conditional</span></code>.</p>
<p>Note that the stiffness matrix does not depend on time so we can
assemble the matrix once and extract the corresponding
<span class="math notranslate nohighlight">\(\emph{scipy}\)</span> sparse matrix.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span>    <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">v</span>    <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">p_in</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="c1"># the following is equivalent to</span>
<span class="c1"># x    = SpatialCoordinate(V)</span>
<span class="c1"># bc   = DirichletBC(V, p_in, conditional(x[0]&lt;1e-10,1,0))</span>
<span class="n">bc</span>   <span class="o">=</span> <span class="n">BoxDirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">p_in</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">],</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">dune.fem.operator</span> <span class="k">import</span> <span class="n">galerkin</span><span class="p">,</span><span class="n">linear</span>
<span class="n">op</span>        <span class="o">=</span> <span class="n">galerkin</span><span class="p">([</span><span class="n">dot</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span><span class="n">bc</span><span class="p">])</span>
<span class="n">S</span>         <span class="o">=</span> <span class="n">linear</span><span class="p">(</span><span class="n">op</span><span class="p">)</span><span class="o">.</span><span class="n">as_numpy</span>
<span class="n">lapPhi</span>    <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="p">)</span>
<span class="n">lapPhiVec</span> <span class="o">=</span> <span class="n">lapPhi</span><span class="o">.</span><span class="n">as_numpy</span>
</pre></div>
</div>
<p>Next we multiply the inverse lumped mass matrix to <span class="math notranslate nohighlight">\(S\)</span>, i.e., we
form the matrix <span class="math notranslate nohighlight">\(\Delta t M^{-1}S\)</span> where <span class="math notranslate nohighlight">\(M\)</span> is a diagonal
matrix with entries <span class="math notranslate nohighlight">\(m_{ii} = \int_\Omega\varphi_i\)</span>. To compute
these values we construct the mass operator
<span class="math notranslate nohighlight">\(&lt;L[u],\varphi_i&gt; = \int_\Omega u\varphi_i\)</span> and apply it to
<span class="math notranslate nohighlight">\(u\equiv 1\)</span></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">dia_matrix</span>
<span class="n">lumping</span> <span class="o">=</span> <span class="n">galerkin</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span>
<span class="n">lumped</span> <span class="o">=</span> <span class="n">lapPhi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">lumping</span><span class="p">(</span><span class="n">lapPhi</span><span class="p">,</span><span class="n">lumped</span><span class="p">)</span>       <span class="c1"># note that lapPhi=1</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lumped</span><span class="o">.</span><span class="n">as_numpy</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">dia_matrix</span><span class="p">(([</span><span class="n">dt</span><span class="o">/</span><span class="n">lumped</span><span class="o">.</span><span class="n">as_numpy</span><span class="p">],[</span><span class="mi">0</span><span class="p">]),</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> <span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">M</span><span class="o">*</span><span class="n">S</span>
</pre></div>
</div>
<p>We can now set up the time loop and perform our explicit time stepping
algorithm. Note that the computation is carried out completely using
<span class="math notranslate nohighlight">\(\emph{numpy}\)</span> and <span class="math notranslate nohighlight">\(\emph{scipy}\)</span> algorithms we
the exception of setting the boundary conditions. This is done using the
<code class="docutils literal notranslate"><span class="pre">setConstraints</span></code> method on the stiffness operator which we constructed
passing in the boundary conditions. At the time of writing it is not yet
possible to extract a sparse matrix and vector encoding the boundary
constraint.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">step</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">T</span><span class="p">:</span>
    <span class="n">step</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">phiVec</span><span class="p">[:]</span> <span class="o">-=</span> <span class="n">pVec</span><span class="p">[:]</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">pVec</span><span class="p">[:]</span>   <span class="o">+=</span> <span class="n">S</span><span class="o">*</span><span class="n">phiVec</span><span class="p">[:]</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
    <span class="c1"># set the values on the Dirichlet boundary</span>
    <span class="n">op</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">op</span><span class="o">.</span><span class="n">setConstraints</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">phiVec</span><span class="p">[:]</span> <span class="o">-=</span> <span class="n">pVec</span><span class="p">[:]</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span>
<span class="n">phi</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gridLines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.02</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/wave_9_0.png" src="_images/wave_9_0.png" />
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="uzawa-scipy.html" class="btn btn-neutral float-right" title="Saddle point solver (using Scipy)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spiral.html" class="btn btn-neutral float-left" title="Spiral Wave" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Andreas Dedner

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>